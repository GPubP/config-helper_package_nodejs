<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@wcm/config-helper</title><meta name="description" content="Documentation for @wcm/config-helper"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@wcm/config-helper</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@wcm/config-helper </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#wcm-config-helper" id="wcm-config-helper" style="color: inherit; text-decoration: none;">
  <h1>WCM Config helper</h1>
</a>
<p>This packages provides the tools to protect your BSL (business service layer) from unwanted requests.</p>
<p>It provides the following tools:</p>

<a href="#interface" id="interface" style="color: inherit; text-decoration: none;">
  <h2>Interface</h2>
</a>

<a href="#create-instance" id="create-instance" style="color: inherit; text-decoration: none;">
  <h3>Create instance</h3>
</a>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">cronFrequency:</span><span class="hl-1"> </span><span class="hl-5">&quot;*/10 * * * * *&quot;</span><span class="hl-1">, </span><span class="hl-6">// optional =&gt; default</span><br/><span class="hl-1">    </span><span class="hl-4">jwtPublicKey:</span><span class="hl-1"> </span><span class="hl-5">&quot;-----BEGIN PUBLIC KEY-----</span><span class="hl-7">\n</span><span class="hl-5">...-----END PUBLIC KEY-----&quot;</span><span class="hl-1">, </span><span class="hl-6">// optional =&gt; defaults to undefined</span><br/><span class="hl-1">    </span><span class="hl-4">kafka:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">host:</span><span class="hl-1"> </span><span class="hl-5">&quot;hostname of kafka&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">origin</span><span class="hl-1">: </span><span class="hl-5">&quot;server origin&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">ca</span><span class="hl-1">: </span><span class="hl-5">&quot;CA PUBLIC KEY&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">key</span><span class="hl-1">: </span><span class="hl-5">&quot;PRIVATE KEY&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">cert</span><span class="hl-1">: </span><span class="hl-5">&quot;PUBLIC KEY&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">systemTopic</span><span class="hl-1">: </span><span class="hl-5">&quot;wcm-digipolis.system&quot;</span><span class="hl-1">; </span><span class="hl-6">// example</span><br/><span class="hl-1">        </span><span class="hl-4">systemGroupId</span><span class="hl-1">: </span><span class="hl-5">&quot;wcm-digipolis.system-portal&quot;</span><span class="hl-1">; </span><span class="hl-6">// example</span><br/><span class="hl-1">    } </span><span class="hl-6">// optional =&gt; defaults to undefined</span><br/><span class="hl-1">});</span>
</code></pre>
<p>Tip:
It is recommended to set kafka variables. 
This will switch the polling behaviour to an event subsription behaviour. 
Subscriptions are far more efficient. This also means that events become more meaningful (see Events section).</p>

<a href="#systemkafkaconsumer" id="systemkafkaconsumer" style="color: inherit; text-decoration: none;">
  <h3>systemKafkaConsumer</h3>
</a>
<p>This is the consumer the TenantsConfig class uses to listen to wcm-digipolis.system (or other) kafka events.
You can subscribe to events yourself when needed.</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    ...</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-4">systemKafkaConsumer</span><span class="hl-1">.</span><span class="hl-3">on</span><span class="hl-1">(</span><span class="hl-5">&#39;tenant-create&#39;</span><span class="hl-1">, (</span><span class="hl-4">message</span><span class="hl-1">: </span><span class="hl-8">KafkaMessage</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// Handle event ...</span><br/><span class="hl-1">});</span><br/>
</code></pre>

<a href="#apikeyguard" id="apikeyguard" style="color: inherit; text-decoration: none;">
  <h3>apiKeyGuard</h3>
</a>
<p>Middleware that converts an apikey to a tenant context and blocks request when the key is not valid.</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-3">use</span><span class="hl-1">(</span><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-4">apiKeyGuard</span><span class="hl-1">);</span>
</code></pre>

<a href="#verifyjwt" id="verifyjwt" style="color: inherit; text-decoration: none;">
  <h3>verifyJwt</h3>
</a>
<p>Middleware that converts an apikey to a tenant context and blocks request when the key is not valid.</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-3">use</span><span class="hl-1">(</span><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-3">verifyJwt</span><span class="hl-1">(</span><span class="hl-5">&quot;PUBLIC KEY&quot;</span><span class="hl-1">));</span>
</code></pre>
<p>You don&#39;t need to pass the token if it is specified in tenantsConfig constructor</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">jwtPublicKey:</span><span class="hl-1"> </span><span class="hl-5">&quot;-----BEGIN PUBLIC KEY-----</span><span class="hl-7">\n</span><span class="hl-5">...-----END PUBLIC KEY-----&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-3">use</span><span class="hl-1">(</span><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-3">verifyJwt</span><span class="hl-1">());</span>
</code></pre>

<a href="#getjwtcontent" id="getjwtcontent" style="color: inherit; text-decoration: none;">
  <h3>getJWTContent</h3>
</a>
<p>Helper that returns the payload of the authorization jwt token set on the req.locals object by the verifyJwt function</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">jwtPublicKey:</span><span class="hl-1"> </span><span class="hl-5">&quot;-----BEGIN PUBLIC KEY-----</span><span class="hl-7">\n</span><span class="hl-5">...-----END PUBLIC KEY-----&quot;</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-3">use</span><span class="hl-1">(</span><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-3">verifyJwt</span><span class="hl-1">());</span><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-3">use</span><span class="hl-1">((</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">, </span><span class="hl-4">next</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// You can get the context after verifyJwt has been called.</span><br/><span class="hl-1">    </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">context</span><span class="hl-1"> = </span><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-3">getJWTContent</span><span class="hl-1">();</span><br/><span class="hl-1">})</span>
</code></pre>

<a href="#getappcontext" id="getappcontext" style="color: inherit; text-decoration: none;">
  <h3>getAppContext</h3>
</a>
<p>Helper that converts an apikey to tenant info.</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-3">getAppContext</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">headers</span><span class="hl-1">.</span><span class="hl-4">apikey</span><span class="hl-1">);</span><br/><br/><span class="hl-6">// returns</span><br/><span class="hl-0">interface</span><span class="hl-1"> </span><span class="hl-8">AppContext</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">_id</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">uuid</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">apikey</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">modules</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-4">module</span><span class="hl-1">: </span><span class="hl-8">AppModule</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">packageName</span><span class="hl-1">?: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">endpoint</span><span class="hl-1">?: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">description</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">version</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">dependencies</span><span class="hl-1">: </span><span class="hl-8">Dependency</span><span class="hl-1">[];</span><br/><span class="hl-1">    }[];</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#getallapps" id="getallapps" style="color: inherit; text-decoration: none;">
  <h3>getAllApps</h3>
</a>
<p>Helper that returns all tenants applicable for your BSL.</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-3">getAllApps</span><span class="hl-1">();</span><br/><br/><span class="hl-6">// returns</span><br/><span class="hl-0">type</span><span class="hl-1"> </span><span class="hl-8">AppContext</span><span class="hl-1"> = </span><span class="hl-8">Array</span><span class="hl-1">&lt;{</span><br/><span class="hl-1">    </span><span class="hl-4">_id</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">uuid</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">apikey</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">modules</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-4">module</span><span class="hl-1">: </span><span class="hl-8">AppModule</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">packageName</span><span class="hl-1">?: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">endpoint</span><span class="hl-1">?: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">description</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">version</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">dependencies</span><span class="hl-1">: </span><span class="hl-8">Dependency</span><span class="hl-1">[];</span><br/><span class="hl-1">    }[];</span><br/><span class="hl-1">}&gt;</span>
</code></pre>

<a href="#requestmodule" id="requestmodule" style="color: inherit; text-decoration: none;">
  <h3>requestModule</h3>
</a>
<p>Request helper to request resources from other BSL&#39;s who have access tot the tenant.</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-3">requestModule</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-5">&quot;tenant-name&quot;</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-5">&quot;target module endpoint&quot;</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-5">&quot;PUT&quot;</span><span class="hl-1">, </span><br/><span class="hl-1">    </span><span class="hl-5">&quot;/path-of-target-module-resource&quot;</span><span class="hl-1">, </span><br/><span class="hl-1">    {</span><br/><span class="hl-1">        </span><span class="hl-4">query:</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-4">something:</span><span class="hl-1"> </span><span class="hl-5">&quot;something&quot;</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">        </span><span class="hl-4">headers:</span><span class="hl-1"> {},</span><br/><span class="hl-1">        </span><span class="hl-4">body:</span><span class="hl-1"> {}</span><br/><span class="hl-1">        </span><span class="hl-6">// ...</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-6">// returns request response</span>
</code></pre>

<a href="#appcontext" id="appcontext" style="color: inherit; text-decoration: none;">
  <h3>AppContext</h3>
</a>
<p>NestJS decorator that uses the getAppContext to get tenant info.</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">AppContext</span><span class="hl-1"> = </span><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-4">AppContext</span><span class="hl-1">;</span><br/><br/><span class="hl-1">@</span><span class="hl-3">Get</span><span class="hl-1">()</span><br/><span class="hl-1">@</span><span class="hl-3">ApiOperation</span><span class="hl-1">({ </span><span class="hl-4">summary:</span><span class="hl-1"> </span><span class="hl-5">&#39;Read all&#39;</span><span class="hl-1">, </span><span class="hl-4">description:</span><span class="hl-1"> </span><span class="hl-5">&#39;Get all resources&#39;</span><span class="hl-1"> })</span><br/><span class="hl-1">@</span><span class="hl-3">ApiOkResponse</span><span class="hl-1">({ </span><span class="hl-4">type:</span><span class="hl-1"> </span><span class="hl-4">SometType</span><span class="hl-1">, </span><span class="hl-4">description:</span><span class="hl-1"> </span><span class="hl-5">&#39;OK&#39;</span><span class="hl-1"> })</span><br/><span class="hl-4">public</span><span class="hl-1"> </span><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-3">read</span><span class="hl-1">(</span><br/><span class="hl-1">    @</span><span class="hl-3">AppContext</span><span class="hl-1">([</span><span class="hl-5">&#39;apikey&#39;</span><span class="hl-1">]) </span><span class="hl-4">targetApikey</span><span class="hl-1">: </span><span class="hl-4">string</span><br/><span class="hl-1">    @</span><span class="hl-3">AppContext</span><span class="hl-1">([</span><span class="hl-5">&#39;name&#39;</span><span class="hl-1">]) </span><span class="hl-4">tenantName</span><span class="hl-1">: </span><span class="hl-4">string</span><br/><span class="hl-1">): </span><span class="hl-8">Promise</span><span class="hl-1">&lt;</span><span class="hl-4">IEmbeddedResponse</span><span class="hl-1">&lt;</span><span class="hl-4">Site</span><span class="hl-1">&gt;&gt; {</span><br/><span class="hl-1">    </span><span class="hl-6">// use apikey and tenantName here</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#getmoduleconfig" id="getmoduleconfig" style="color: inherit; text-decoration: none;">
  <h3>getModuleConfig</h3>
</a>
<p>Get the module config received from wcm-admin</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">tenantsConfig</span><span class="hl-1"> = </span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-3">TenantsConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-4">baseUrl:</span><span class="hl-1"> </span><span class="hl-5">&quot;base-url of your service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">apikey:</span><span class="hl-1"> </span><span class="hl-5">&quot;your-apikey&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">moduleConfig</span><span class="hl-1"> = </span><span class="hl-4">tenantsConfig</span><span class="hl-1">.</span><span class="hl-3">getModuleConfig</span><span class="hl-1">();</span><br/><br/><span class="hl-6">// returns</span><br/><span class="hl-0">interface</span><span class="hl-1"> </span><span class="hl-8">ModuleConfig</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">_id</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">uuid</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">meta</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-4">deleted</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">lastModified</span><span class="hl-1">: </span><span class="hl-8">Date</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">created</span><span class="hl-1">: </span><span class="hl-8">Date</span><span class="hl-1">;</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">    </span><span class="hl-4">data</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-4">name</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">moduleType</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-4">versions</span><span class="hl-1">: {</span><br/><span class="hl-1">            </span><span class="hl-4">version</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-4">description</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-4">endpoint</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-4">dependencies</span><span class="hl-1">: </span><span class="hl-8">Dependency</span><span class="hl-1">[];</span><br/><span class="hl-1">        }[];</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">};</span>
</code></pre>

<a href="#getappmoduleconfig" id="getappmoduleconfig" style="color: inherit; text-decoration: none;">
  <h3>getAppModuleConfig</h3>
</a>
<p>Get the custom module config for a tenant received from wcm-admin.
In the website config in wcm-admin, a module can be given additional custom config for a specific tenant (JSon format). 
Use this method to retrieve this custom config in a BSL. 
It is strongly advised to cache this response in the BSL for performance reasons.</p>
<pre><code class="language-ts"><span class="hl-6">// Returns the JSon object as stored in wcm-admin</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">customConfig</span><span class="hl-1"> = </span><span class="hl-4">tenantConfig</span><span class="hl-1">.</span><span class="hl-3">getAppModuleConfig</span><span class="hl-1">(</span><span class="hl-4">tenantUuid</span><span class="hl-1">);</span>
</code></pre>

<a href="#events" id="events" style="color: inherit; text-decoration: none;">
  <h2>Events</h2>
</a>
<table>
<thead>
<tr>
<th>name</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody><tr>
<td>ready</td>
<td>ModuleContext</td>
<td>ModuleConfig has been fetched and set for the first time.</td>
</tr>
<tr>
<td>config-updated</td>
<td>ModuleContext</td>
<td>ModuleConfig has been update through polling or event (depends on kafka setting).</td>
</tr>
</tbody></table>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/TenantsConfig.html" class="tsd-kind-icon">Tenants<wbr/>Config</a></li><li class="tsd-kind-interface"><a href="interfaces/AppContext.html" class="tsd-kind-icon">App<wbr/>Context</a></li><li class="tsd-kind-interface"><a href="interfaces/AppModule.html" class="tsd-kind-icon">App<wbr/>Module</a></li><li class="tsd-kind-interface"><a href="interfaces/AppModuleData.html" class="tsd-kind-icon">App<wbr/>Module<wbr/>Data</a></li><li class="tsd-kind-interface"><a href="interfaces/AppModuleMeta.html" class="tsd-kind-icon">App<wbr/>Module<wbr/>Meta</a></li><li class="tsd-kind-interface"><a href="interfaces/AppModuleVersion.html" class="tsd-kind-icon">App<wbr/>Module<wbr/>Version</a></li><li class="tsd-kind-interface"><a href="interfaces/BSLRequest.html" class="tsd-kind-icon">BSLRequest</a></li><li class="tsd-kind-interface"><a href="interfaces/GatewayJWTContent.html" class="tsd-kind-icon">GatewayJWTContent</a></li><li class="tsd-kind-interface"><a href="interfaces/ModuleConfig.html" class="tsd-kind-icon">Module<wbr/>Config</a></li><li class="tsd-kind-interface"><a href="interfaces/ModuleContext.html" class="tsd-kind-icon">Module<wbr/>Context</a></li><li class="tsd-kind-interface"><a href="interfaces/PortalConfig.html" class="tsd-kind-icon">Portal<wbr/>Config</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>